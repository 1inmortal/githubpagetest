<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
  <!-- Metadatos, Favicon, Fuentes, Font Awesome -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1.0, user-scalable=no">
  <title>Cyberpunk 2077 - Evidencias (v3.4 - Hacker Terminal Load)</title>
  <meta name="author" content="Ing. Espinosa Martínez José Armando"><meta name="copyright" content="© 2025 Ing. Espinosa Martínez José Armando">
  <link rel="icon" href="IMG/FAVICON/LOGO.png" type="image/x-icon" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=VT323&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Animate.css (opcional) -->
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" ... /> -->

  <style>
    /* VARIABLES CSS (Cyberdeck OS Mejorado) */
    :root {
      --primary-color: #00f0ff; --primary-color-rgb: 0, 240, 255; /* Cyan */
      --secondary-color: #ff00ff; --secondary-color-rgb: 255, 0, 255; /* Magenta */
      --accent-color: #f7ff00; --accent-color-rgb: 247, 255, 0;    /* Amarillo */
      --background-color: #03060c; /* Azul muy muy oscuro */
      --panel-bg-color: rgba(10, 25, 45, 0.88); /* Azul oscuro ligeramente más saturado */
      --panel-bg-color-rgb: 10, 25, 45;
      --text-color: #d0e0ff; /* Azul muy claro */
      --text-muted-color: #88a0b8; /* Gris azulado */
      --border-color: rgba(var(--primary-color-rgb), 0.4);
      --highlight-bg: rgba(var(--primary-color-rgb), 0.18);
      --selected-bg: var(--primary-color); --selected-text: #03060b;
      --danger-color: #ff3355; --success-color: #0aff99; /* Verde Neón */ --warning-color: #ffcc00; /* Naranja/Dorado */ --override-color: #ff8800; /* Naranja */ --boot-color: #cccccc; /* Gris claro */ --kernel-color: #88ffff; /* Cyan claro */ --net-color: #ff99ff;   /* Rosa claro */ --sec-color: #ff6666;   /* Rojo claro */ --sys-color: var(--primary-color); /* Color primario para SYS */

      --font-main: 'Orbitron', sans-serif; --font-secondary: 'Rajdhani', sans-serif;
      --font-glitch: 'VT323', monospace; --font-mono: 'Share Tech Mono', monospace;
      --animation-speed: 0.8s; --base-font-size: 15px;
    }
    /* MODO CLARO */
     html[data-theme='light'] { --background-color: #f0f4f8; --panel-bg-color: rgba(255, 255, 255, 0.92); --panel-bg-color-rgb: 255, 255, 255; --text-color: #1c2a3a; --text-muted-color: #5a6a7a; --border-color: rgba(66, 153, 225, 0.5); --selected-text: #ffffff; --primary-color: #0056b3; --primary-color-rgb: 0, 86, 179; --secondary-color: #c72570; --secondary-color-rgb: 199, 37, 112; --accent-color: #d97706; --accent-color-rgb: 217, 119, 6; --danger-color: #cc2929; --success-color: #2f855a; --warning-color: #dd6b20; --override-color: #ed8936; --boot-color: #444; --kernel-color: #007a7a; --net-color: #a855f7; --sec-color: #b91c1c; --sys-color: var(--primary-color); }
    /* MODO ALTO CONTRASTE */
    html[data-theme='high-contrast'] { --primary-color: #ffff00; --primary-color-rgb: 255, 255, 0; --secondary-color: #ff00ff; --secondary-color-rgb: 255, 0, 255; --accent-color: #00ffff; --accent-color-rgb: 0, 255, 255; --background-color: #000; --panel-bg-color: rgba(0, 0, 0, 0.98); --panel-bg-color-rgb: 0,0,0; --text-color: #ffffff; --text-muted-color: #f0f0f0; --border-color: var(--primary-color); --selected-bg: var(--primary-color); --selected-text: #000; --success-color: #00ff00; --danger-color: #ff0000; --warning-color: #ffff00; --override-color: #ff9900; --boot-color: #fff; --kernel-color: #0ff; --net-color: #f0f; --sec-color: #f00; --sys-color: var(--primary-color);}

    /* --- RESET Y BASE --- */
    * { margin: 0; padding: 0; box-sizing: border-box; } html { font-size: var(--base-font-size); scroll-behavior: smooth; } body { background-color: var(--background-color); color: var(--text-color); font-family: var(--font-secondary), var(--font-mono), sans-serif; overflow-x: hidden; position: relative; padding-top: 65px; transition: background-color 0.5s ease, color 0.5s ease; }

    /* --- EFECTOS DE FONDO --- */
    body::after { /* Scanlines */ content:''; position:fixed; inset:0; background:linear-gradient(rgba(10,25,45,0) 50%,rgba(0,0,0,0.1) 50%), linear-gradient(90deg,rgba(255,255,255,0.02) 1px,transparent 1px); background-size:100% 2px, 2px 100%; z-index:-1; pointer-events:none; animation:scanlineAnim 0.15s linear infinite alternate; opacity:.3; transition:opacity .5s ease; html[data-theme='light'] & {opacity:.04;} html[data-theme='high-contrast'] & {display:none;} } body.scanlines-disabled::after { opacity:0!important; } @keyframes scanlineAnim{0%{background-position:0 0}100%{background-position:0 2px}}
    #tsparticles { position: fixed; inset: 0; z-index: -2; }

    /* --- NUEVO LOADER TERMINAL --- */
    .loader-overlay { position:fixed; inset:0; background:var(--background-color); display:flex; align-items:center; justify-content:center; z-index:9999; opacity:1; visibility:visible; transition:opacity .6s ease .8s, visibility 0s 1.4s; /* Delay más largo */ }
    .loader-overlay.hidden { opacity:0; visibility:hidden; transition-delay:0s, 0s; }
    #terminalOutput { font-family: var(--font-mono); font-size: clamp(0.75rem, 2vw, 0.95rem); /* Más pequeño */ color: var(--success-color); width: 95%; max-width: 800px; height: 80vh; max-height: 600px; overflow-y: auto; padding: 20px; border: 1px solid var(--border-color); background: rgba(0,0,0, 0.7); border-radius: 4px; box-shadow: inset 0 0 15px rgba(var(--primary-color-rgb), 0.25), 0 0 20px rgba(var(--primary-color-rgb), 0.1); scrollbar-width: thin; scrollbar-color: var(--primary-color) rgba(0,0,0,0.3); text-shadow: 0 0 2px rgba(var(--success-color), 0.5); /* Ligero brillo al texto */ }
    #terminalOutput::-webkit-scrollbar { width: 6px; } #terminalOutput::-webkit-scrollbar-thumb { background: var(--primary-color); border-radius: 3px; } #terminalOutput::-webkit-scrollbar-track { background: rgba(0,0,0,0.4); border-radius: 3px; }
    .terminal-line { display: block; white-space: pre-wrap; margin-bottom: 0.2em; /* Más junto */ opacity: 0; animation: terminalFadeIn 0.05s forwards; position: relative; }
    @keyframes terminalFadeIn { from { opacity: 0; } to { opacity: 1; } }
    .terminal-line.cursor::after { content:'█'; display:inline-block; margin-left:4px; color:var(--accent-color); animation:blink-caret-terminal .8s step-end infinite; text-shadow: 0 0 5px var(--accent-color); /* Brillo cursor */}
    @keyframes blink-caret-terminal { from, to { opacity: 0; } 50% { opacity: 1; } }
    /* Prefijos y Status */
    .terminal-line .prefix { margin-right: 8px; font-weight: bold; }
    .prefix-boot   { color: var(--boot-color); } .prefix-kernel { color: var(--kernel-color); }
    .prefix-net    { color: var(--net-color); }  .prefix-sec    { color: var(--sec-color); }
    .prefix-sys    { color: var(--sys-color); }  .prefix-user   { color: var(--secondary-color); }
    .terminal-line .status { font-weight: bold; padding: 0 3px;}
    .status-ok       { color: var(--success-color); }
    .status-warn     { color: var(--warning-color); animation: terminalPulseWarn 1.5s infinite; }
    .status-fail     { color: var(--danger-color); animation: terminalPulseFail 1s infinite; text-transform: uppercase;}
    .status-override { color: var(--override-color); font-style: italic;}
    @keyframes terminalPulseWarn { 0%,100% {opacity:1;} 50% {opacity:.7;} } @keyframes terminalPulseFail { 0%,100% {opacity:1;} 50% {opacity:.5;} }

    /* --- BARRA PROGRESO SCROLL --- */
    .scroll-progress-bar { position: fixed; top: 0; left: 0; height: 5px; background: linear-gradient(90deg, var(--secondary-color), var(--primary-color), var(--accent-color)); width: 0%; z-index: 1031; box-shadow: 0 0 10px var(--primary-color); transition: width 0.1s linear; }

    /* --- HEADER / NAVEGACIÓN --- */
    header.cyber-nav { position:fixed; top:0; left:0; width:100%; height:65px; display:flex; align-items:center; justify-content:space-between; padding:0 25px; background:var(--panel-bg-color); border-bottom:1px solid var(--border-color); backdrop-filter:blur(10px); z-index:1030; transition:background-color .3s ease, box-shadow .3s ease; }
    body.scrolled header.cyber-nav { background: rgba(var(--panel-bg-color-rgb), 0.95); box-shadow: 0 2px 15px rgba(0,0,0,0.4); }
    .nav-brand { font-family: var(--font-main); font-size: 1.5rem; color: var(--primary-color); text-decoration: none; text-shadow: 0 0 5px var(--primary-color); transition: text-shadow 0.3s; }
    .nav-brand:hover { text-shadow: 0 0 10px var(--primary-color), 0 0 5px var(--accent-color);}
    .hamburger { position: relative; background: transparent; border: 1px solid var(--border-color); cursor: pointer; z-index: 2000; display: flex; flex-direction: column; gap: 5px; padding: 8px; border-radius: 4px; transition: border-color 0.2s, transform 0.2s; }
    .hamburger:hover { border-color: var(--primary-color); transform: scale(1.05);}
    .hamburger .bar { width: 25px; height: 3px; background-color: var(--text-muted-color); transition: background-color var(--transition-fast), transform 0.3s ease; }
    .hamburger:hover .bar { background-color: var(--primary-color); } .hamburger.active .bar:nth-child(1) { transform: translateY(8px) rotate(45deg); } .hamburger.active .bar:nth-child(2) { opacity: 0; } .hamburger.active .bar:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }

    /* --- PANEL DE FILTRO/NAVEGACIÓN --- */
    .filter-overlay { position: fixed; inset: 0; background: rgba(var(--background-color-rgb), 0.96); backdrop-filter: blur(12px); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1999; opacity: 0; visibility: hidden; transition: opacity 0.5s ease, visibility 0s 0.5s; }
    .filter-overlay.active { opacity: 1; visibility: visible; transition-delay: 0s; } .filter-content ul { list-style: none; text-align: center; padding: 0; margin: 0;} .filter-content li { margin-bottom: 2rem; }
    .filter-content a.filter-link { font-family: var(--font-main); font-size: clamp(1.6rem, 6vw, 2.4rem); color: var(--text-muted-color); text-transform: uppercase; letter-spacing: 3px; transition: color 0.3s ease, text-shadow 0.3s ease, transform 0.2s ease; position: relative; display: inline-block; padding: 5px 0; text-decoration: none; }
    .filter-content a.filter-link::before, .filter-content a.filter-link::after { content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; background: transparent; color: var(--primary-color); opacity: 0; transition: opacity 0.3s ease; pointer-events: none;} .filter-content a.filter-link::before { clip: rect(0, 90px, 0, 0); text-shadow: -1px 0 var(--secondary-color); } .filter-content a.filter-link::after { clip: rect(0, 900px, 50px, 0); text-shadow: 1px 0 var(--accent-color); }
    .filter-content a.filter-link:hover { color: var(--primary-color); text-shadow: 0 0 12px var(--primary-color), 0 0 6px var(--secondary-color); transform: scale(1.03); }
    .filter-content a.filter-link:hover::before, .filter-content a.filter-link:hover::after { opacity: 1; animation: glitchAnimMenu 1s cubic-bezier(.25,.46,.45,.94) both infinite; } .filter-content a.filter-link:hover::after { animation-duration: 0.8s; animation-direction: reverse; }
    @keyframes glitchAnimMenu{ /* ... */ 0%{clip:rect(47px,9999px,95px,0)}5%{clip:rect(26px,9999px,40px,0)}10%{clip:rect(66px,9999px,71px,0)}15%{clip:rect(33px,9999px,6px,0)}20%{clip:rect(19px,9999px,88px,0)}25%{clip:rect(8px,9999px,61px,0)}30%{clip:rect(62px,9999px,7px,0)}35%{clip:rect(64px,9999px,79px,0)}40%{clip:rect(18px,9999px,54px,0)}45%{clip:rect(15px,9999px,74px,0)}50%{clip:rect(93px,9999px,99px,0)}55%{clip:rect(97px,9999px,67px,0)}60%{clip:rect(2px,9999px,9px,0)}65%{clip:rect(87px,9999px,93px,0)}70%{clip:rect(76px,9999px,39px,0)}75%{clip:rect(54px,9999px,96px,0)}80%{clip:rect(92px,9999px,41px,0)}85%{clip:rect(42px,9999px,28px,0)}90%{clip:rect(62px,9999px,79px,0)}95%{clip:rect(17px,9999px,78px,0)}100%{clip:rect(73px,9999px,4px,0)} }
    .theme-toggle-menu { margin-top: 1.5rem; padding: 0.7rem 1.8rem; font-size: 1rem; border: 1px solid var(--accent-color); color: var(--accent-color); background: transparent; cursor: pointer; transition: 0.3s; font-family: var(--font-main); text-transform: uppercase; letter-spacing: 1px; border-radius: 4px; display: inline-flex; align-items: center; gap: 10px; }
    .theme-toggle-menu:hover { background: var(--accent-color); color: var(--selected-text); box-shadow: 0 0 15px var(--accent-color); } .theme-toggle-menu .fa-sync-alt { transition: transform 0.5s ease-in-out;} .theme-toggle-menu:hover .fa-sync-alt { transform: rotate(180deg);}

    /* --- NOTIFICACIONES --- */
    .notification-container { position: fixed; bottom: 20px; right: 20px; z-index: 1100; display: flex; flex-direction: column; gap: 10px; width: 90%; max-width: 320px; max-height: 80vh; overflow-y: auto; pointer-events: none; } .cyber-notification { pointer-events: all; background: rgba(var(--panel-bg-color-rgb), 0.95); backdrop-filter: blur(8px); color: var(--text-color); padding: 14px 20px; border-radius: 5px; margin-bottom: 10px; border-left: 5px solid var(--primary-color); box-shadow: 0 5px 15px rgba(0,0,0,0.4); opacity: 0; transform: translateX(30px); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; align-items: center; gap: 12px; font-size: 0.98rem; } .cyber-notification.visible { opacity: 1; transform: translateX(0); }

    /* --- INTRODUCCIÓN ANIMADA --- */
    .intro-section { padding: 35px 25px; text-align: left; max-width: 750px; margin: 40px auto; font-family: var(--font-mono), monospace; color: var(--text-muted-color); line-height: 1.7; opacity: 0; transform: translateY(25px); transition: opacity .8s ease-out .4s, transform .8s ease-out .4s; border-left: 4px solid var(--primary-color); background: rgba(var(--panel-bg-color-rgb), 0.5); border-radius: 0 6px 6px 0; box-shadow: inset 4px 0 10px rgba(var(--primary-color-rgb), 0.25); position: relative; z-index: 5; }
    .intro-section.visible { opacity: 1; transform: translateY(0); }
    .intro-line { margin-bottom: 0.6em; white-space: nowrap; overflow: hidden; border-right: .1em solid var(--accent-color); width: 0; opacity: 0; display: inline-block; vertical-align: bottom; animation-fill-mode: forwards; animation-timing-function: steps(45, end); /* Más pasos */ }
    @keyframes typing { from { width: 0; opacity: 1; } to { width: 100%; opacity: 1; } } @keyframes blink-caret { from, to { border-color: transparent; } 50% { border-color: var(--accent-color); text-shadow: 0 0 3px var(--accent-color);} }
     .intro-section.visible .intro-line { animation: typing 1.8s forwards, blink-caret .7s step-end infinite; } /* Duración typing ajustada */
     .intro-section.visible #introLine1 { animation-delay: 0.6s, 0.6s; }
     .intro-section.visible #introLine2 { animation-delay: 2.6s, 2.6s; animation-duration: 2.2s, 0.7s; }
     .intro-section.visible #introLine3 { animation-delay: 5.0s, 5.0s; animation: typing 1.6s steps(45, end) 5.0s forwards, blink-caret .7s step-end 5.0s 3; /* Parpadeo más largo */ }
     @media (max-width: 768px) { .intro-section { padding: 25px 20px; max-width: 95%; margin: 25px auto; } .intro-line { font-size: 0.9rem; } } @media (max-width: 480px) { .intro-line { font-size: 0.85rem; border-right-width: 0.09em; } }

    /* --- HERO --- */
    .hero { position: relative; min-height: calc(80vh - 65px); display: flex; align-items: center; justify-content: center; text-align: center; padding: 2rem; overflow: hidden; background: linear-gradient(rgba(var(--background-color-rgb), 0.7), var(--background-color)), radial-gradient(circle at center, rgba(var(--primary-color-rgb), 0.05) 0%, transparent 60%); }
    .hero-content { opacity: 0; transform: translateY(40px); } .hero-content.visible-animate { opacity: 1; transform: translateY(0);} /* Activado por Observer */
    .hero-title { font-family: var(--font-glitch); font-size: clamp(2.5rem, 7vw, 4.5rem); color: var(--primary-color); text-transform: uppercase; margin-bottom: 1rem; text-shadow: 0 0 10px var(--primary-color), 0 0 20px var(--primary-color), 0 0 5px var(--secondary-color); position: relative; }
     .hero-title::before, .hero-title::after { content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent; overflow: hidden; clip: rect(0, 900px, 0, 0); opacity: 0.8; pointer-events: none;} .hero-title::before { left: 3px; text-shadow: -2px 0 var(--secondary-color); animation: glitchAnim 2s infinite linear alternate-reverse -0.5s; } .hero-title::after { left: -3px; text-shadow: 2px 0 var(--accent-color); animation: glitchAnim2 2.5s infinite linear alternate-reverse; }
    .hero-subtitle { font-size: clamp(1rem, 3vw, 1.2rem); color: var(--text-muted-color); line-height: 1.7; max-width: 700px; margin: 0 auto 2.5rem auto; text-shadow: 1px 1px 2px rgba(0,0,0,0.7); }
    .btn-hero { background: transparent; color: var(--primary-color); border: 2px solid var(--primary-color); border-radius: 5px; padding: 0.8rem 2rem; font-size: 1.1rem; font-family: var(--font-main); text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s ease; cursor: pointer; position: relative; overflow: hidden; } .btn-hero::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, var(--primary-color), transparent); transition: left 0.4s ease; } .btn-hero:hover::before { left: 100%; } .btn-hero:hover { color: var(--selected-text); background: var(--primary-color); box-shadow: 0 0 15px var(--primary-color), 0 0 25px var(--primary-color); }

    /* --- PROYECTO X & ANIMACIONES PANELES --- */
    .projectx-section { max-width: var(--max-container-width); margin: 40px auto; padding: 2.5rem; border-radius: 8px; background: var(--panel-bg-color); border: 1px solid var(--border-color); box-shadow: 0 5px 25px rgba(var(--primary-color-rgb), 0.1); }
    .projectx-section h2 { font-family: var(--font-main); text-align: center; margin-bottom: 2.5rem; color: var(--primary-color); text-shadow: 0 0 8px var(--primary-color); font-size: 2rem; text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center; justify-content: center; gap: 10px;}
    .projectx-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2.5rem; }
    .projectx-details, .projectx-visuals, .projectx-video { background: rgba(var(--panel-bg-color-rgb), 0.7); /* Ligeramente más visible */ border: 1px solid rgba(var(--border-color), 0.8); border-radius: 6px; padding: 1.8rem; box-shadow: inset 0 0 12px rgba(0,0,0,0.4); }
    .animation-trigger { opacity:0; transition:opacity .7s ease-out, transform .7s ease-out; will-change:transform,opacity; }
    .animation-trigger.visible-animate { opacity:1; transform:none!important; }
    .animate-slide-in-left { transform: translateX(-40px); } .animate-slide-in-right { transform: translateX(40px); } .animate-fade-scale-up { transform: scale(.97); } .animate-slide-in-bottom { transform: translateY(40px); }
     /* Delays diferentes */
     #proyectoX h2.animation-trigger              { transition-delay: 0s; }
     .projectx-details.animation-trigger       { transition-delay: 0.15s; }
     .projectx-visuals.animation-trigger       { transition-delay: 0.25s; }
     .projectx-video.animation-trigger         { transition-delay: 0.35s; }

    .projectx-details h3, .projectx-visuals h3, .projectx-video h3 { font-family:var(--font-main); color:var(--secondary-color); margin-bottom:1rem; font-size:1.4rem; border-bottom:1px dashed var(--secondary-color); padding-bottom:.6rem; display:flex; align-items:center; gap:8px; } .projectx-details p { color:var(--text-muted-color); line-height:1.7; font-size:1rem; margin-bottom:1rem; } .projectx-details ul { list-style:none; padding-left:0; } .projectx-details li { margin-bottom:.9rem; padding-left:1.8rem; position:relative; color:var(--text-color); font-size:1rem; } .projectx-details li::before { content:"\f101"; font-family:"Font Awesome 6 Free"; font-weight:900; position:absolute; left:0; top:3px; color:var(--accent-color); font-size:1em; } .projectx-details li strong { color:var(--primary-color); font-weight:700; } .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; } .gallery img { width:100%; border-radius:4px; border:1px solid var(--border-color); transition:transform .3s ease,box-shadow .3s ease,filter .3s ease; cursor:pointer; aspect-ratio:1 / 1; object-fit:cover; } .gallery img:hover { transform:scale(1.08); box-shadow:0 0 15px var(--accent-color); border-color:var(--accent-color); filter:brightness(1.1); } .projectx-video video { width:100%; border:1px solid var(--border-color); border-radius:4px; display:block; }

    /* --- VISUALIZADOR MUSICA --- */
    .music-visualizer { position:fixed; bottom:10px; left:50%; transform:translateX(-50%); display:flex; align-items:flex-end; gap:4px; height:40px; z-index:1000; filter:drop-shadow(0 0 5px var(--secondary-color)); pointer-events:none; } .music-visualizer .bar { width:6px; height:5px; background:var(--secondary-color); border-radius:2px; animation:bounceVisualizer 1.2s infinite ease-in-out alternate; } .music-visualizer .bar:nth-child(1){background:var(--primary-color);animation-delay:-.4s} .music-visualizer .bar:nth-child(2){background:var(--accent-color);animation-delay:-.2s} .music-visualizer .bar:nth-child(3){background:var(--secondary-color);animation-delay:0s} .music-visualizer .bar:nth-child(4){background:var(--accent-color);animation-delay:.2s} .music-visualizer .bar:nth-child(5){background:var(--primary-color);animation-delay:.4s} @keyframes bounceVisualizer{0%,100%{height:5px;opacity:.5}50%{height:40px;opacity:1}}

    /* --- PANEL DE PREFERENCIAS --- */
    .preferences-panel { position: fixed; right: -260px; top: 100px; width: 260px; background: var(--panel-bg-color); backdrop-filter: blur(8px); border: 1px solid var(--border-color); border-right: none; border-radius: 8px 0 0 8px; padding: 1.5rem; z-index: 1029; transition: right 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55); } .preferences-panel.open { right: 0; } .preferences-toggle { position: absolute; left: -40px; top: 20px; background: var(--secondary-color); border: none; color: var(--selected-text); cursor: pointer; border-radius: 5px 0 0 5px; width: 40px; height: 40px; font-size: 1.2rem; font-weight: bold; padding: 0; display: flex; align-items: center; justify-content: center; box-shadow: -2px 2px 8px rgba(0,0,0,0.3); } .preferences-toggle i { transition: transform 0.3s ease; } .preferences-panel.open .preferences-toggle i { transform: rotate(180deg); } .preferences-panel h4 { margin-bottom: 1rem; font-family: var(--font-main); color: var(--primary-color); text-transform: uppercase; font-size: 1.1rem; border-bottom: 1px dashed var(--border-color); padding-bottom: 0.5rem; display: flex; align-items: center; gap: 8px;} .form-check { display: flex; align-items: center; margin-bottom: 1rem; } .form-check-input { opacity: 0; width: 0; height: 0; position: absolute; } .form-check-label { margin-left: 0; font-size: 1rem; color: var(--text-muted-color); position: relative; padding-left: 35px; cursor: pointer; transition: color 0.2s; user-select: none; line-height: 20px; } .form-check-label:hover { color: var(--primary-color); } .form-check-label::before { content: ''; position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 20px; height: 20px; background: rgba(var(--primary-color-rgb), 0.1); border: 1px solid var(--border-color); border-radius: 3px; transition: background-color 0.2s, border-color 0.2s; } .form-check-label::after { content: '\f00c'; font-family: "Font Awesome 6 Free"; font-weight: 900; position: absolute; left: 4px; top: 50%; transform: translateY(-50%) scale(0); font-size: 13px; color: var(--accent-color); transition: transform 0.2s ease-out; } .form-check-input:checked + .form-check-label::before { background-color: var(--primary-color); border-color: var(--primary-color); box-shadow: 0 0 8px var(--primary-color); } .form-check-input:checked + .form-check-label::after { transform: translateY(-50%) scale(1); }

    /* --- FOOTER --- */
    footer { text-align: center; padding: 2rem; margin: 20px; margin-bottom: 0; border-top: 1px solid var(--border-color); background: var(--panel-bg-color); } footer p { font-size: 0.9rem; color: var(--text-muted-color); }

    /* --- EASTER EGG --- */
    .easter-egg-msg { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); background: linear-gradient(45deg, var(--secondary-color), var(--accent-color)); color: #000; font-weight: bold; padding: 1rem 2rem; border-radius: 5px; display: none; z-index: 5000; box-shadow: 0 5px 20px rgba(0,0,0,0.4); font-family: var(--font-glitch); animation: pulseEgg 1s infinite alternate; } @keyframes pulseEgg { from { transform: translateX(-50%) scale(1); } to { transform: translateX(-50%) scale(1.05); } }

    /* --- MEDIA QUERIES --- */
    @media (max-width: 992px) { body{padding-top:60px} header.cyber-nav{height:60px;padding:0 15px} .preferences-panel{top:80px} .projectx-container{gap:1.5rem} .projectx-section{padding:2rem;margin:30px auto} }
    @media (max-width: 768px) { html{font-size:calc(var(--base-font-size) - 1px)} body{padding-top:55px} header.cyber-nav{height:55px} .projectx-container{grid-template-columns:1fr} .preferences-panel{width:220px;right:-220px;padding:1.2rem} .preferences-panel.open{right:0} .preferences-toggle{left:-35px;width:35px;height:35px;font-size:1rem} }
    @media (max-width: 480px) { html{font-size:calc(var(--base-font-size) - 2px)} body{padding-top:50px} header.cyber-nav{height:50px;padding:0 10px} .nav-brand{font-size:1.2rem} .hamburger{gap:4px;padding:6px} .hamburger .bar{width:20px;height:2px} .hamburger.active .bar:nth-child(1){transform:translateY(6px) rotate(45deg)} .hamburger.active .bar:nth-child(3){transform:translateY(-6px) rotate(-45deg)} .filter-content a.filter-link{font-size:clamp(1.2rem, 5vw, 1.8rem)} .hero-title{font-size:clamp(1.8rem, 8vw, 2.8rem)} .projectx-section{padding:1.5rem;margin:20px auto;} .projectx-details h3, .projectx-visuals h3, .projectx-video h3{font-size:1.2rem} footer{padding:1.5rem} }

  </style>
</head>

<body id="bodyElement">

  <!-- LOADER Y BARRA DE PROGRESO -->
  <div class="scroll-progress-bar" id="scrollProgressBar"></div>
  <div class="loader-overlay" id="loaderOverlay">
      <div id="terminalOutput"></div> <!-- Contenido generado por JS -->
  </div>

  <!-- FONDO Y PARTÍCULAS -->
  <div class="particles" id="tsparticles"></div>

  <!-- AUDIOS -->
  <audio id="audio-hover" src="Audio/hover.mp3" preload="auto"></audio>
  <audio id="audio-click" src="Audio/Sound-mp3/Sound.mp3" preload="auto"></audio>
  <audio id="background-audio" loop><source src="Audio/Stardust_ Relaxing Ambient Sci Fi Music.mp3" type="audio/mpeg"></audio>
  <audio id="audio-loader" src="Audio/loader.mp3" preload="auto"></audio>
  <audio id="audio-notification" src="Audio/ui-notification.wav" preload="auto"></audio>
  <audio id="terminal-boot-sound" src="Audio/terminal-boot.mp3" preload="auto"></audio> <!-- Ajustar ruta -->
  <audio id="terminal-keypress-sound" src="Audio/terminal-keypress.wav" preload="auto"></audio> <!-- Ajustar ruta -->


  <!-- NAVEGACIÓN SUPERIOR -->
  <header class="cyber-nav" id="headerNav">
    <a class="nav-brand" href="../index.html" onclick="playSound(audioClick)">Evidencias 2077</a>
    <button class="hamburger" aria-label="Toggle Navigation Menu" id="hamburgerBtn">
      <span class="bar"></span><span class="bar"></span><span class="bar"></span>
    </button>
  </header>

  <!-- PANEL DE FILTRO/NAVEGACIÓN -->
  <div class="filter-overlay" id="filterOverlay">
    <div class="filter-content">
      <ul>
        <li><a class="filter-link" data-text="DISEÑO" href="diseños/Menu.html">DISEÑO</a></li>
        <li><a class="filter-link" data-text="PRESENTACION" href="presentacion/presentacion.html">PRESENTACIÓN</a></li>
        <li><a class="filter-link" data-text="PROYECTO X" href="Proyecto x/main.html">PROYECTO X</a></li>
        <li><a class="filter-link" data-text="LABORATORIO" href="laboratorio/index.html">LABORATORIO</a></li>
        <li style="margin-top: 2rem; border-top: 1px solid var(--border-color); padding-top: 2rem;">
            <button class="theme-toggle-menu" id="themeToggleMenu" aria-label="Cambiar tema">
                <i class="fas fa-sync-alt"></i> Ciclar Tema Matrix
            </button>
        </li>
      </ul>
    </div>
  </div>

   <!-- Contenedor Notificaciones -->
   <div id="notificationContainer" class="notification-container" aria-live="polite"></div>

   <!-- SECCIÓN: INTRODUCCIÓN ANIMADA -->
  <section class="intro-section" id="introDescription">
      <p class="intro-line" id="introLine1"></p>
      <p class="intro-line" id="introLine2"></p>
      <p class="intro-line" id="introLine3"></p>
  </section>

  <!-- HERO -->
  <section class="hero" id="hero">
    <div class="hero-content animation-trigger animate-slide-in-bottom">
      <h1 class="hero-title" data-text="EVIDENCIAS // 2077">EVIDENCIAS // 2077</h1>
      <p class="hero-subtitle">
          Navega a través de los fragmentos de código y diseño recuperados. La Red es vasta, la información espera. Cuidado con el Black ICE.
      </p>
      <button class="btn-hero" onclick="document.getElementById('proyectoX').scrollIntoView(); playSound(audioClick)">Explorar Archivos</button>
    </div>
  </section>

  <!-- PROYECTO X -->
  <section class="projectx-section" id="proyectoX">
    <h2 class="animation-trigger animate-fade-scale-up"><i class="fas fa-project-diagram"></i> Proyecto X // Classified</h2>
    <div class="projectx-container">
      <div class="projectx-details animation-trigger animate-slide-in-left">
        <h3><i class="fas fa-microchip"></i> Core Logic & Data</h3>
        <p>Simulación neural avanzada para análisis predictivo de flujos de datos en la Red. Implementa algoritmos de cifrado cuántico y evasión de ICE.</p>
        <ul>
          <li><strong>Motor:</strong> Quantum Weaver X</li> <li><strong>IA:</strong> Cerebrus v7.1</li>
          <li><strong>Red:</strong> GhostNet Secure Channel</li> <li><strong>Defensa:</strong> Chimera ICE Breaker Suite</li>
        </ul>
      </div>
      <div class="projectx-visuals animation-trigger animate-fade-scale-up">
        <h3><i class="fas fa-palette"></i> Interface Visuals</h3>
        <div class="gallery">
          <img src="src/img/cyberpunk.jpg" alt="Interfaz Holográfica" loading="lazy" />
          <img src="src/img/panel2.jpg" alt="Esquema Neural" loading="lazy" />
          <img src="src/img/panel3.jpg" alt="Visualización Datos" loading="lazy" />
          <img src="src/img/gotic.jpg" alt="Esquema Hardware" loading="lazy" />
          <img src="src/img/blanca como la nieve.jpg" alt="Acceso Biométrico" loading="lazy"/>
          <img src="src/img/celestial.jpg" alt="Núcleo Energía" loading="lazy"/>
        </div>
      </div>
      <div class="projectx-video animation-trigger animate-slide-in-right">
        <h3><i class="fas fa-play-circle"></i> Operational Demo</h3>
        <video controls preload="metadata" poster="src/img/panel_video_poster.jpg">
          <source src="Proyecto x/src/video/videoplayback (2).mp4" type="video/mp4" />
          Tu navegador no soporta la etiqueta de video.
        </video>
      </div>
    </div>
  </section>

  <!-- VISUALIZADOR MUSICA -->
  <div class="music-visualizer" id="musicVisualizer">
    <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
  </div>

  <!-- PANEL PREFERENCIAS -->
  <div class="preferences-panel closed" id="preferencesPanel">
    <button class="preferences-toggle" id="preferencesToggleBtn" aria-label="Toggle Preferences Panel">
      <i class="fas fa-chevron-left"></i>
    </button>
    <h4><i class="fas fa-cog"></i> Interface Config</h4>
    <div class="form-check"><input class="form-check-input" type="checkbox" id="particlesToggle"><label class="form-check-label" for="particlesToggle">Data Particles</label></div>
    <div class="form-check"><input class="form-check-input" type="checkbox" id="scanlinesToggle"><label class="form-check-label" for="scanlinesToggle">Scanlines FX</label></div>
    <div class="form-check"><input class="form-check-input" type="checkbox" id="soundsToggle"><label class="form-check-label" for="soundsToggle">Auditory Feedback</label></div>
    <div class="form-check"><input class="form-check-input" type="checkbox" id="animationsToggle"><label class="form-check-label" for="animationsToggle">Panel Animations</label></div>
  </div>

  <!-- FOOTER -->
  <footer id="contact"><p>© 2077 J.A.E.M. // Data Cache Archived // Secure Connection</p></footer>
  <!-- EASTER EGG -->
  <div class="easter-egg-msg" id="easterEggMsg">Ice bypassed! Deep Network Access granted. Welcome, Ghost.</div>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@1/tsparticles.min.js"></script>
   <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DOM & Global Vars ---
        const d=document; const bodyElement=d.body; const headerNav=d.getElementById('headerNav'); const hamburgerBtn=d.getElementById('hamburgerBtn'); const filterOverlay=d.getElementById('filterOverlay'); const filterLinks=d.querySelectorAll('.filter-link'); const particlesDiv=d.getElementById('tsparticles'); const preferencesPanel=d.getElementById('preferencesPanel'); const preferencesToggleBtn=d.getElementById('preferencesToggleBtn'); const notificationContainer=d.getElementById('notificationContainer'); const themeToggleMenu=d.getElementById('themeToggleMenu'); const introDescription=d.getElementById('introDescription'); const introLinesElements=[d.getElementById('introLine1'),d.getElementById('introLine2'),d.getElementById('introLine3')]; const scrollProgressBar=d.getElementById('scrollProgressBar'); const loaderOverlay=d.getElementById('loaderOverlay'); const terminalOutput=d.getElementById('terminalOutput'); const easterEggMsg=d.getElementById('easterEggMsg');
        // Audios
        const audioHover=d.getElementById('audio-hover'); const audioClick=d.getElementById('audio-click'); const backgroundAudio=d.getElementById('background-audio'); const audioLoader=d.getElementById('audio-loader'); const audioNotify=d.getElementById('audio-notification'); const terminalBootSound=d.getElementById('terminal-boot-sound'); const terminalKeySound=d.getElementById('terminal-keypress-sound');
        // Pref Toggles
        const pT=d.getElementById('particlesToggle'); const sT=d.getElementById('scanlinesToggle'); const SndT=d.getElementById('soundsToggle'); const aT=d.getElementById('animationsToggle');
        // State
        let cT=localStorage.getItem('theme')||'dark'; let sE=localStorage.getItem('soundEnabled')!=='false'; let scE=localStorage.getItem('scanlinesEnabled')!=='false'; let pE=localStorage.getItem('particlesEnabled')!=='false'; let aE=localStorage.getItem('animationsEnabled')!=='false'; let eC=0; window.animationSpeedFactor=parseFloat(localStorage.getItem('animationSpeedFactor'))||0.8;

        // --- UTILS ---
        function playSound(aE,vol=1.0){if(!sE||!aE||typeof aE.play!=='function')return;aE.volume=vol;if(aE.readyState>=3){aE.currentTime=0;aE.play().catch(e=>console.warn("Audio!",e.message));}else{const h=()=>{aE.currentTime=0;aE.play().catch(e=>console.warn("Audio!(canplay)",e.message));};aE.addEventListener('canplaythrough',h,{once:true});}}
        function showNotification(m,t='info'){playSound(audioNotify);const iC={info:'fas fa-info-circle',success:'fas fa-check-circle',warn:'fas fa-exclamation-triangle',error:'fas fa-times-circle'}[t]||'fas fa-bell';const c={info:'var(--primary-color)',success:'var(--success-color)',warn:'var(--warning-color)',error:'var(--danger-color)'}[t]||'var(--primary-color)';const p={info:'[SYS]',success:'[OK]',warn:'[WARN]',error:'[ERR]'}[t]||'[SYS]';if(!notificationContainer){return;}const n=d.createElement('div');n.className=`cyber-notification ${t}`;n.style.borderLeftColor=c;n.innerHTML=`<i class="${iC}" style="color:${c};font-size:1.2em;"></i><span><strong style="color:${c};margin-right:5px;">${p}</strong> ${m}</span>`;notificationContainer.insertBefore(n,notificationContainer.firstChild);void n.offsetWidth;n.classList.add('visible');const rm=()=>{n.classList.remove('visible');n.addEventListener('transitionend',()=>n.remove(),{once:true});};n.addEventListener('click',rm);setTimeout(rm,5000);}

        // --- THEME ---
        function applyTheme(th){d.documentElement.setAttribute('data-theme',th);localStorage.setItem('theme',th);cT=th;if(typeof loadParticles==='function'&&pE){loadParticles();}}
        function cycleTheme(){playSound(audioClick);const th=['dark','light','high-contrast'];applyTheme(th[(th.indexOf(cT)+1)%th.length]);showNotification(`Theme Matrix: ${cT.replace('-',' ')}`,'info');}
        function loadInitialTheme(){applyTheme(cT);}

        // --- PREFERENCES ---
        function applyPreferences(){localStorage.setItem('soundEnabled',sE);bodyElement.classList.toggle('scanlines-disabled',!scE);localStorage.setItem('scanlinesEnabled',scE);localStorage.setItem('particlesEnabled',pE);if(pE){if(window.tsParticles){const pt=tsParticles.domItem(0);if(!pt?.started)loadParticles();pt?.play();}else{loadParticles();}}else{window.tsParticles?.domItem(0)?.pause();}localStorage.setItem('animationsEnabled',aE); d.querySelectorAll('.animation-trigger').forEach(el=>el.style.transition=aE?'':'none');}
        function loadPreferences(){sE=localStorage.getItem('soundEnabled')!=='false';scE=localStorage.getItem('scanlinesEnabled')!=='false';pE=localStorage.getItem('particlesEnabled')!=='false';aE=localStorage.getItem('animationsEnabled')!=='false';if(SndT)SndT.checked=sE;if(sT)sT.checked=scE;if(pT)pT.checked=pE;if(aT)aT.checked=aE;applyPreferences();}

        // --- EFFECTS ---
        function manageParallax(){} // Placeholder - No longer needed for video
        function getThemeColorsForParticles(){const s=getComputedStyle(d.documentElement);return{primary:s.getPropertyValue('--primary-color').trim()||'#00f0ff',secondary:s.getPropertyValue('--secondary-color').trim()||'#ff00ff',accent:s.getPropertyValue('--accent-color').trim()||'#f7ff00',primaryRgb:s.getPropertyValue('--primary-color-rgb').trim()||'0,240,255'};}
        function loadParticles(){if(typeof tsParticles==='undefined'||!pE){window.tsParticles?.domItem(0)?.destroy();return;}const c=getThemeColorsForParticles();tsParticles.load("tsparticles",{fpsLimit:60,particles:{number:{value:80,density:{enable:true,area:700}},color:{value:[c.primary,c.secondary,c.accent]},shape:{type:["circle","edge"]},opacity:{value:{min:0.1,max:0.6},animation:{enable:true,speed:.9*window.animationSpeedFactor,minimumValue:0.05,sync:false}},size:{value:{min:.8,max:2.2},animation:{enable:true,speed:5*window.animationSpeedFactor,minimumValue:0.4,sync:false}},links:{color:`rgba(${c.primaryRgb},0.15)`,distance:110,enable:true,opacity:.1,width:1},move:{enable:true,speed:1.5*window.animationSpeedFactor,direction:"none",random:true,straight:false,outModes:{default:"bounce"},attract:{enable:true, rotateX:600, rotateY:1200}}},interactivity:{detectsOn:"window",events:{onHover:{enable:true,mode:"bubble"},onClick:{enable:true,mode:"push"},resize:true},modes:{repulse:{distance:80,duration:0.4/window.animationSpeedFactor},push:{quantity:4},bubble:{distance:150,size:3,duration:2,opacity:.8}}},detectRetina:true,background:{}}).catch(e=>console.error("tsParticles err:",e));}

        // --- BOOT SEQUENCE / LOADER ---
        const bootSequence = [
            { text: "█▓▒▒░░ CYBERDECK OS v3.4 :: EVIDENCE VAULT ░░▒▒▓█", delay: 150, type:'boot'},
            { text: " ", delay: 80 },
            { text: "<span class='prefix-boot'>[BOOT]</span> Cold Boot Sequence Initiated...", delay: 100},
            { text: "<span class='prefix-boot'>[BOOT]</span> CPU Checksum...... <span class='status-ok'>[PASS]</span>", delay: 200},
            { text: "<span class='prefix-kernel'>[KERNEL]</span> Loading Core Modules...", delay: 120},
            { text: "       > module: KERNEL_SYS_INTEGRITY <span class='status-ok'>[OK]</span>", delay: 180},
            { text: "       > module: NEURAL_LINK_API_v4.7 <span class='status-ok'>[OK]</span>", delay: 150},
            { text: "<span class='prefix-kernel'>[KERNEL]</span> Peripheral Scan:", delay: 100},
            { text: "       > KIROSHI Optics Mk.III.... <span class='status-ok'>[DETECTED]</span>", delay: 250},
            { text: "       > Tactical ICE Interface.... <span class='status-warn'>[DEGRADED]</span> - Recalibration recommended.", delay: 300, type: 'warn'},
            { text: " ", delay: 80 },
            { text: "<span class='prefix-net'>[NET]</span> Initiating Grid Connection Sequence...", delay: 130},
            { text: "<span class='prefix-net'>[NET]</span> Scanning Local Nodes... 192.168.77.1", delay: 200},
            { text: "<span class='prefix-net'>[NET]</span> DNS Resolver... nightcity.datahaven <span class='status-fail'>[FAIL]</span>", delay: 350, type: 'fail'},
            { text: "<span class='prefix-net'>[NET]</span> Attempting SatCom Uplink // Relay Sigma-7...", delay: 250},
            { text: "<span class='prefix-net'>[NET]</span> Uplink established. Bandwidth: 1.2 Tb/s <span class='status-ok'>[SECURE_TUNNEL]</span>", delay: 300},
            { text: " ", delay: 80 },
            { text: "<span class='prefix-sec'>[SEC]</span> Deploying Counter-Intrusion Environment...", delay: 150},
            { text: "<span class='prefix-sec'>[SEC]</span> Firewall Protocol: <span class='status-override'>[BLACKWALL_v6_MODIFIED]</span>", delay: 300, type: 'override'},
            { text: "<span class='prefix-sec'>[SEC]</span> Daemon Scan: <span class='status-ok'>[CLEAN]</span>", delay: 200},
            { text: "<span class='prefix-sec'>[SEC]</span> Watchdog Routine Engaged.", delay: 120},
            { text: " ", delay: 80 },
            { text: "<span class='prefix-sys'>[SYS]</span> Mounting Data Archive '/evidence/projects'...", delay: 180},
            { text: "<span class='prefix-sys'>[SYS]</span> Archive Integrity Hash: <span class='prefix-user'>[a4f7b1e8...]</span> <span class='status-ok'>[VERIFIED]</span>", delay: 300},
            { text: "<span class='prefix-sys'>[SYS]</span> UI Matrix Initialized: 'Netrunner Classic' Theme", delay: 150},
            { text: " ", delay: 100 },
            { text: "<span class='status-ok'>##### SYSTEM READY // AUTHENTICATION COMPLETE #####</span>", delay: 200, type: 'ok' },
            { text: "Welcome, Operator. Evidence Vault accessible.", delay: 250, type: 'ok' }
        ];

        function runBootSequence() {
            let delay = 100; let currentCursorLine = null;
            playSound(terminalBootSound, 0.4);

            bootSequence.forEach((lineData, index) => {
                setTimeout(() => {
                    if (terminalOutput) {
                         const newLine = d.createElement('p');
                         newLine.classList.add('terminal-line');

                         let lineContent = lineData.text;
                         if (lineData.prefix) { // Add prefix span if defined
                             lineContent = `<span class='prefix-${lineData.prefix.toLowerCase()}'>[${lineData.prefix}]</span> ${lineContent}`;
                         } else if (lineData.type && lineData.type !== 'boot' && lineData.text.trim() !== '') {
                            // Wrap full lines with status types for coloring
                            // Exclude boot prefix and empty lines from needing [SYS] default
                         } else if (lineData.text.trim() !== '' && !lineData.type && !lineData.text.includes('[')) {
                             // Add default prefix for system messages without explicit status
                             // lineContent = `<span class='prefix-sys'>[SYS]</span> ${lineContent}`;
                         }

                        newLine.innerHTML = lineContent; // Use innerHTML for spans

                        terminalOutput.appendChild(newLine);
                        if(currentCursorLine) currentCursorLine.classList.remove('cursor');
                        newLine.classList.add('cursor'); currentCursorLine = newLine;
                        terminalOutput.scrollTop = terminalOutput.scrollHeight;
                        if(lineData.text.trim().length > 0) playSound(terminalKeySound, 0.1); // Sound per visible line

                        if (index === bootSequence.length - 1) {
                             setTimeout(() => {
                                 playSound(audioLoader); // Sound for sequence end
                                 loaderOverlay.classList.add('hidden');
                                 if(backgroundAudio) backgroundAudio.play().catch(e=>console.warn("BG audio!"));
                                 if(introDescription) {
                                     const txtLs=["> ARCHIVE NODE 'PROJECT_X' ACCESSED...", "> LOADING ENCRYPTED DATA FRAGMENTS...", "> DISPLAYING VISUAL & OPERATIONAL EVIDENCE."];
                                     introLinesElements.forEach((l, i)=>{if(l) l.textContent=txtLs[i]||'';});
                                     introDescription.classList.add('visible');
                                 }
                                 initPanelObserver(); // Start panel animations observer
                             }, 1000); // Longer delay after final line
                         }
                    }
                }, delay);
                delay += lineData.delay + Math.random() * 50; // Add randomness to delay
            });
        }


        // --- INIT & LISTENERS ---
        window.addEventListener('scroll', ()=>{/*...*/ const sT=window.pageYOffset||d.documentElement.scrollTop;const dH=d.documentElement.scrollHeight-window.innerHeight;const sP=dH>0?(sT/dH)*100:0;if(scrollProgressBar)scrollProgressBar.style.width=sP+'%';if(headerNav)headerNav.classList.toggle('scrolled',sT>50);}, {passive:true, context:{d}});
        if(hamburgerBtn && filterOverlay){hamburgerBtn.addEventListener('click',(e)=>{e.stopPropagation();const a=hamburgerBtn.classList.toggle('active');filterOverlay.classList.toggle('active',a);bodyElement.style.overflow=a?'hidden':'';playSound(audioClick);if(pP&&pP.classList.contains('open')){pP.classList.remove('open');pTB.querySelector('i').style.transform='';}});filterOverlay.addEventListener('click',(e)=>{if(e.target===filterOverlay){hamburgerBtn.classList.remove('active');filterOverlay.classList.remove('active');bodyElement.style.overflow='';playSound(audioClick);}});filterLinks.forEach(l=>{l.addEventListener('mouseenter',()=>playSound(audioHover));l.addEventListener('click',()=>{hamburgerBtn.classList.remove('active');filterOverlay.classList.remove('active');bodyElement.style.overflow='';playSound(audioClick);});});if(themeToggleMenu){themeToggleMenu.addEventListener('click',cycleTheme);}}
        const pP = preferencesPanel, pTB = preferencesToggleBtn; if(pP&&pTB){pTB.addEventListener('click',()=>{const o=pP.classList.toggle('open');pTB.querySelector('i').style.transform=o?'rotate(180deg)':'rotate(0deg)';playSound(audioClick);});[pT,sT,SndT,aT].forEach(t=>{if(t){t.addEventListener('change',e=>{switch(e.target.id){case'particlesToggle':pE=e.target.checked;break;case'scanlinesToggle':scE=e.target.checked;break;case'soundsToggle':sE=e.target.checked;break;case'animationsToggle':aE=e.target.checked;break;}playSound(audioClick);applyPreferences();});}});}
        if(easterEggMsg){d.addEventListener('keydown',e=>{if(e.key==='x'&&e.altKey&&e.ctrlKey){eC++;if(eC===1){easterEggMsg.style.display='block';showNotification("SECRET NODE DETECTED // Access Granted!","success");playSound(audioNotify,0.8);setTimeout(()=>{easterEggMsg.style.display='none';},4000);eC=0;}}else{eC=0;}});}

        // ** Intersection Observer para paneles **
        function initPanelObserver() {
            const observerElements = d.querySelectorAll('.animation-trigger');
            if (observerElements.length === 0 || typeof IntersectionObserver === 'undefined') return;
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                     if (entry.isIntersecting) { // Entra en la vista
                        if (aE) { // Solo animar si está activado
                            entry.target.classList.add('visible-animate');
                        } else { // Si animaciones están desactivadas, solo mostrar
                            entry.target.style.opacity = 1; // Forzar visibilidad sin transición
                            entry.target.style.transform = 'none';
                        }
                        // observer.unobserve(entry.target); // Para animar solo una vez
                     } else { // Sale de la vista
                        entry.target.classList.remove('visible-animate');
                         // No resetear opacity/transform aquí si animas solo una vez
                     }
                });
            }, { threshold: 0.15, rootMargin: "0px 0px -60px 0px" }); // Ajustar margen
             observerElements.forEach(el => { observer.observe(el); });
        }


        // --- INICIO ---
        loadPreferences(); loadInitialTheme(); loadParticles();
        runBootSequence();

    }); // Fin DOMContentLoaded
   </script>

</body>
</html>