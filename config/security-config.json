{
  "security": {
    "headers": {
      "X-Content-Type-Options": "nosniff",
      "X-Frame-Options": "DENY",
      "X-XSS-Protection": "1; mode=block",
      "Referrer-Policy": "strict-origin-when-cross-origin",
      "Cross-Origin-Opener-Policy": "same-origin",
      "Cross-Origin-Resource-Policy": "same-origin",
      "Cross-Origin-Embedder-Policy": "require-corp",
      "Strict-Transport-Security": "max-age=31536000; includeSubDomains; preload",
      "Permissions-Policy": "geolocation=(), microphone=(), camera=(), payment=(), usb=()"
    },
    "csp": {
      "defaultSrc": ["'self'"],
      "scriptSrc": [
        "'self'",
        "'nonce-${nonce}'",
        "https://www.googletagmanager.com",
        "https://cdnjs.cloudflare.com",
        "https://www.google-analytics.com"
      ],
      "styleSrc": [
        "'self'",
        "'nonce-${nonce}'",
        "https://fonts.googleapis.com",
        "https://cdn.jsdelivr.net"
      ],
      "fontSrc": [
        "'self'",
        "https://fonts.gstatic.com",
        "https://cdn.jsdelivr.net"
      ],
      "imgSrc": [
        "'self'",
        "data:",
        "https:",
        "https://www.google-analytics.com"
      ],
      "connectSrc": [
        "'self'",
        "https://www.google-analytics.com"
      ],
      "frameSrc": ["'none'"],
      "objectSrc": ["'none'"],
      "baseUri": ["'self'"],
      "formAction": ["'self'"]
    },
    "rateLimiting": {
      "general": {
        "windowMs": 900000,
        "max": 100,
        "message": "Demasiadas requests desde esta IP, intenta de nuevo más tarde."
      },
      "chat": {
        "windowMs": 60000,
        "max": 10,
        "message": "Demasiados mensajes, espera un momento."
      },
      "api": {
        "windowMs": 300000,
        "max": 50,
        "message": "Demasiadas requests a la API, intenta de nuevo más tarde."
      }
    },
    "sanitization": {
      "maxInputLength": 1000,
      "maxUrlLength": 2048,
      "maxFormDataSize": 10485760,
      "allowedFileTypes": [
        "text/plain",
        "text/html",
        "text/css",
        "text/javascript",
        "application/json",
        "application/xml",
        "image/jpeg",
        "image/png",
        "image/gif",
        "image/webp",
        "application/pdf"
      ],
      "allowedSchemes": ["http", "https", "mailto", "tel"],
      "dangerousPatterns": [
        "javascript:",
        "data:image/svg+xml",
        "vbscript:",
        "file:",
        "expression(",
        "onload=",
        "onerror=",
        "onclick="
      ]
    },
    "validation": {
      "email": {
        "pattern": "^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",
        "maxLength": 254
      },
      "name": {
        "pattern": "^[a-zA-ZÀ-ÿ\\s\\-']+$",
        "maxLength": 100
      },
      "number": {
        "pattern": "^[0-9]+$",
        "maxLength": 20
      },
      "url": {
        "maxLength": 2048,
        "allowedProtocols": ["http:", "https:"]
      }
    },
    "crypto": {
      "boundaryLength": {
        "min": 20,
        "max": 70
      },
      "randomBytes": 32,
      "nonceLength": 16
    },
    "cookies": {
      "secure": true,
      "httpOnly": true,
      "sameSite": "strict",
      "domain": ".github.io",
      "maxAge": 86400000
    }
  },
  "monitoring": {
    "enabled": true,
    "logLevel": "info",
    "securityEvents": {
      "rateLimitExceeded": true,
      "invalidInput": true,
      "xssAttempt": true,
      "sqlInjectionAttempt": true,
      "cspViolation": true
    }
  },
  "compliance": {
    "gdpr": {
      "enabled": true,
      "dataRetention": "30d",
      "userConsent": true
    },
    "owasp": {
      "top10": true,
      "secureCoding": true
    },
    "nist": {
      "cybersecurity": true
    }
  }
}
