{
  "security": {
    "headers": {
      "X-Content-Type-Options": "nosniff",
      "X-Frame-Options": "DENY",
      "X-XSS-Protection": "1; mode=block",
      "Referrer-Policy": "strict-origin-when-cross-origin",
      "Content-Security-Policy": "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;"
    },
    "rateLimiting": {
      "general": {
        "windowMs": 900000,
        "max": 100,
        "message": "Demasiadas requests desde esta IP, intenta de nuevo más tarde."
      },
      "chat": {
        "windowMs": 60000,
        "max": 10,
        "message": "Demasiados mensajes, espera un momento."
      },
      "api": {
        "windowMs": 300000,
        "max": 50,
        "message": "Demasiadas requests a la API, intenta de nuevo más tarde."
      }
    },
    "sanitization": {
      "maxInputLength": 1000,
      "maxUrlLength": 2048,
      "maxFormDataSize": 10485760,
      "allowedFileTypes": [
        "text/plain",
        "text/html",
        "text/css",
        "text/javascript",
        "application/json",
        "application/xml",
        "image/jpeg",
        "image/png",
        "image/gif",
        "image/webp",
        "application/pdf"
      ],
      "allowedSchemes": ["http", "https", "mailto", "tel"],
      "dangerousPatterns": [
        "javascript:",
        "data:image/svg+xml",
        "vbscript:",
        "file:",
        "expression(",
        "onload=",
        "onerror=",
        "onclick="
      ]
    },
    "validation": {
      "email": {
        "pattern": "^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",
        "maxLength": 254
      },
      "name": {
        "pattern": "^[a-zA-ZÀ-ÿ\\s\\-']+$",
        "maxLength": 100
      },
      "number": {
        "pattern": "^[0-9]+$",
        "maxLength": 20
      },
      "url": {
        "maxLength": 2048,
        "allowedProtocols": ["http:", "https:"]
      }
    },
    "crypto": {
      "boundaryLength": {
        "min": 20,
        "max": 70
      },
      "randomBytes": 32
    }
  },
  "monitoring": {
    "enabled": true,
    "logLevel": "info",
    "securityEvents": {
      "rateLimitExceeded": true,
      "invalidInput": true,
      "xssAttempt": true,
      "sqlInjectionAttempt": true
    }
  },
  "compliance": {
    "gdpr": {
      "enabled": true,
      "dataRetention": "30d",
      "userConsent": true
    },
    "owasp": {
      "top10": true,
      "secureCoding": true
    }
  }
}
